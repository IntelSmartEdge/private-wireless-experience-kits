# INTEL CONFIDENTIAL
#
# Copyright 2020-2020 Intel Corporation.
#
# This software and the related documents are Intel copyrighted materials, and your use of
# them is governed by the express license under which they were provided to you ("License").
# Unless the License provides otherwise, you may not use, modify, copy, publish, distribute,
# disclose or transmit this software or the related documents without Intel's prior written permission.
#
# This software and the related documents are provided as is, with no express or implied warranties,
# other than those that are expressly stated in the License.

---

# This file contains variables intended to be configured by user.
# It allows feature enabling and configuration.
# Per-host variables should be places in `host_vars` directory.
# Features should not be configured by changing roles' defaults (i.e. role/defaults/main.yml)

## Kernel configuration
# Skip kernel configuration
# If true, kernel will not be installed.
# If false, package composed from variables kernel_package and kernel_version will be installed together with it's devel
kernel_skip: false

# Version of the kernel.
kernel_version: 3.10.0-1160.11.1.rt56.1145.el7.x86_64

## GRUB configuration

# Disable sriov kernel flags (intel_iommu=on iommu=pt)
iommu_enabled: true

# Enabled hugepages
hugepages_enabled: true
# Size of a single hugepage (2M or 1G)
default_hugepage_size: 1G
# Amount of hugepages
hugepages_1G: 40
hugepages_2M: 0

# Configure cpu_idle_driver
cpu_idle_driver_setup_enabled: true
cpu_idle_driver: poll

# isolcpus_enabled controls the CPU isolation mechanisms configured via grub command line.
isolcpus_enabled: false
# isolcpus is parameter for isolcpus, rcu_nocbs, nohz_full kernel command line arguments.
# CPUs to be isolated (for RT procesess)
# For more information visit https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.htm
# This variable is required.
isolcpus: "2-23"

# os_cpu_affinity_cpus pins the kthread and irq processing to selected cores using kthread_cpus and irqaffinity
# kernel command line arguments.
# CPUs not to be isolate (for non-RT processes) - minimum of two OS cores necessary for controller
# For more information visit https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.htm
# Does nothing when empty.
os_cpu_affinity_cpus: "0-1"

# Autogenerate isolated cores based on `cmk_exclusive_num_cores` when `cmk_enabled=true`.
autogenerate_isolcpus: false

# Enable additional grub parameters
additional_grub_parameters_enabled: false
additional_grub_parameters: "selinux=0 enforcing=0 nmi_watchdog=0 softlockup_panic=0 usbcore.autosuspend=-1 audit=0 mce=off pci=realloc rdt=l3cat"

## Tuned configuration
# Skip tuned configuration
# If true, tuned will not be configured
# If false, tuned_packages will be installed, tuned_profile will be applied with tuned_vars
tuned_skip: false

# Packages to install
tuned_packages:
  - tuned-2.11.0-9.el7
  - http://ftp.scientificlinux.org/linux/scientific/7.9/x86_64/os/Packages/tuned-profiles-realtime-2.11.0-9.el7.noarch.rpm
# Profile to be applied
tuned_profile: realtime
# Variables applied with the profile
tuned_vars: |
  isolated_cores={{ cpu_isol }}
  nohz=on
  nohz_full={{ cpu_isol }}

## Set tuned latency_enable setting.
tuned_force_latency_enable: true

ptp_sync_enable: true

# ptp_port keeps the host's interface(s) connected to:
# - a PTP MASTER node, in this case it should keep only one interface name, e.g.:
#   ptp_port: enp134s0f1
# - PTP SLAVE(S), then should store a list of interfaces connected to slaves, e.g.:
#   ptp_port:
#   - enp134s0f1
# - Grand Master only for single node setup, then it should keep one interface name:
ptp_port: "eno2"

# ptp_port_gm is the host's interface connected to a Grand Master:
ptp_port_gm: "eno2"

# ptp_network_transport keeps network transport for ptp.
# Valid options:
# -2 Select the IEEE 802.3 network transport.
# -4 Select the UDP IPv4 network transport.
ptp_network_transport: "-2"

# Grand Master IP, e.g. (set this value for the single node setup):
gm_ip: "169.254.99.9"

# Set the following values for the single node setup.
# If DHCP support on GMC is not enabled:
# - ptp_port_ip contains a static IP for the server port connected to GMC:
ptp_port_ip: "169.254.99.175"
ptp_port_cidr: "16"
